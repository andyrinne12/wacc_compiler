simpleTest.wacc
calling the reference compiler on simpleTest.wacc
-- Test: simpleTest.wacc

-- Uploaded file: 
---------------------------------------------------------------
begin
  int f(int a, int b, int c) is
    return (a + b + c)
  end
  int g(int a, int b, int c) is
    int a = call f(a,b,c);
    return (a + b + c)
  end
  int a = call f(0,1,2);
  int[] b = [];
  string d = "cleopatra";
  int x = b[5]
end
---------------------------------------------------------------

-- Compiler Output:
-- Compiling...
-- Printing Assembly...
simpleTest.s contents are:
===========================================================
0	.data
1	
2	msg_0:
3		.word 82
4		.ascii	"OverflowError: the result is too small/large to store in a 4-byte signed-integer.\n"
5	msg_1:
6		.word 5
7		.ascii	"%.*s\0"
8	
9	.text
10	
11	.global main
12	f_f:
13		PUSH {lr}
14		LDR r4, [sp, #4]
15		LDR r5, [sp, #8]
16		ADDS r4, r4, r5
17		BLVS p_throw_overflow_error
18		LDR r5, [sp, #12]
19		ADDS r4, r4, r5
20		BLVS p_throw_overflow_error
21		MOV r0, r4
22		POP {pc}
23		POP {pc}
24		.ltorg
25	f_g:
26		PUSH {lr}
27		SUB sp, sp, #4
28		LDR r4, [sp, #16]
29		STR r4, [sp, #-4]!
30		LDR r4, [sp, #16]
31		STR r4, [sp, #-4]!
32		LDR r4, [sp, #16]
33		STR r4, [sp, #-4]!
34		BL f_f
35		ADD sp, sp, #12
36		MOV r4, r0
37		STR r4, [sp]
38		LDR r5, [sp, #12]
39		ADDS r4, r4, r5
40		BLVS p_throw_overflow_error
41		LDR r5, [sp, #16]
42		ADDS r4, r4, r5
43		BLVS p_throw_overflow_error
44		MOV r0, r4
45		ADD sp, sp, #4
46		POP {pc}
47		POP {pc}
48		.ltorg
49	main:
50		PUSH {lr}
51		SUB sp, sp, #16
52		LDR r4, =2
53		STR r4, [sp, #-4]!
54		LDR r4, =1
55		STR r4, [sp, #-4]!
56		LDR r4, =0
57		STR r4, [sp, #-4]!
58		BL f_f
59		ADD sp, sp, #12
60		ADD sp, sp, #16
61		LDR r0, =0
62		POP {pc}
63		.ltorg
64	p_throw_overflow_error:
65		LDR r0, =msg_0
66		BL p_throw_runtime_error
67	p_throw_runtime_error:
68		BL p_print_string
69		MOV r0, #-1
70		BL exit
71	p_print_string:
72		PUSH {lr}
73		LDR r1, [r0]
74		ADD r2, r0, #4
75		LDR r0, =msg_1
76		ADD r0, r0, #4
77		BL printf
78		MOV r0, #0
79		BL fflush
80		POP {pc}
81	
===========================================================
-- Finished

